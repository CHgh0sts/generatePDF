{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/chghosts/Developpement/test%20gemini%203/components/InvoiceRenderer.tsx"],"sourcesContent":["import React from 'react';\n\nexport interface EditorElement {\n  id: string;\n  type: 'text' | 'image' | 'box' | 'line';\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n  content?: string;\n  style?: React.CSSProperties;\n}\n\nexport default function InvoiceRenderer({ elements, id }: { elements: EditorElement[], id?: string }) {\n  return (\n    <div \n      id={id}\n      className=\"bg-white shadow-none relative print:shadow-none\"\n      style={{ width: '794px', height: '1123px', position: 'relative', overflow: 'hidden' }}\n    >\n      {elements.map((element) => (\n        <div\n          key={element.id}\n          style={{\n            position: 'absolute',\n            top: element.y,\n            left: element.x,\n            width: element.w,\n            height: element.h,\n            ...element.style,\n          }}\n        >\n          {element.type === 'text' && <div className=\"w-full h-full whitespace-pre-wrap\">{element.content}</div>}\n          {element.type === 'box' && <div className=\"w-full h-full bg-gray-200 border border-gray-400\"></div>}\n          {element.type === 'line' && <div className=\"w-full h-[2px] bg-black mt-[50%]\"></div>}\n        </div>\n      ))}\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;;AAae,SAAS,gBAAgB,EAAE,QAAQ,EAAE,EAAE,EAA8C;IAClG,qBACE,8OAAC;QACC,IAAI;QACJ,WAAU;QACV,OAAO;YAAE,OAAO;YAAS,QAAQ;YAAU,UAAU;YAAY,UAAU;QAAS;kBAEnF,SAAS,GAAG,CAAC,CAAC,wBACb,8OAAC;gBAEC,OAAO;oBACL,UAAU;oBACV,KAAK,QAAQ,CAAC;oBACd,MAAM,QAAQ,CAAC;oBACf,OAAO,QAAQ,CAAC;oBAChB,QAAQ,QAAQ,CAAC;oBACjB,GAAG,QAAQ,KAAK;gBAClB;;oBAEC,QAAQ,IAAI,KAAK,wBAAU,8OAAC;wBAAI,WAAU;kCAAqC,QAAQ,OAAO;;;;;;oBAC9F,QAAQ,IAAI,KAAK,uBAAS,8OAAC;wBAAI,WAAU;;;;;;oBACzC,QAAQ,IAAI,KAAK,wBAAU,8OAAC;wBAAI,WAAU;;;;;;;eAZtC,QAAQ,EAAE;;;;;;;;;;AAiBzB"}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file:///Users/chghosts/Developpement/test%20gemini%203/app/dashboard/generate/%5Bid%5D/PdfGenerator.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef } from 'react';\nimport InvoiceRenderer, { EditorElement } from '@/components/InvoiceRenderer';\nimport html2canvas from 'html2canvas';\nimport jsPDF from 'jspdf';\nimport { Download, ArrowLeft } from 'lucide-react';\nimport Link from 'next/link';\n\nexport default function PdfGenerator({ template }: { template: any }) {\n  const [elements, setElements] = useState<EditorElement[]>(() => {\n    try { return JSON.parse(template.content); } catch { return []; }\n  });\n  \n  // Simple variable state\n  const [variables, setVariables] = useState({\n    client: 'Nom du Client',\n    date: new Date().toLocaleDateString(),\n    number: 'FAC-001'\n  });\n\n  const rendererRef = useRef<HTMLDivElement>(null);\n\n  const handleDownload = async () => {\n    const element = document.getElementById('print-target');\n    if (!element) return;\n\n    const canvas = await html2canvas(element, {\n      scale: 2, // Higher quality\n      logging: false,\n      useCORS: true\n    });\n\n    const imgData = canvas.toDataURL('image/png');\n    const pdf = new jsPDF('p', 'mm', 'a4');\n    const pdfWidth = pdf.internal.pageSize.getWidth();\n    const pdfHeight = pdf.internal.pageSize.getHeight();\n    \n    pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);\n    pdf.save(`facture-${variables.number}.pdf`);\n  };\n\n  // Inject variables into elements for rendering\n  const renderedElements = elements.map(el => {\n    if (el.type === 'text' && el.content) {\n      let newContent = el.content;\n      Object.entries(variables).forEach(([key, value]) => {\n        newContent = newContent.replace(new RegExp(`{{${key}}}`, 'g'), value);\n      });\n      return { ...el, content: newContent };\n    }\n    return el;\n  });\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 flex flex-col\">\n      <div className=\"bg-white shadow p-4 flex justify-between items-center sticky top-0 z-10\">\n        <div className=\"flex items-center gap-4\">\n          <Link href=\"/dashboard\" className=\"text-gray-500 hover:text-gray-700\"><ArrowLeft /></Link>\n          <h1 className=\"font-bold text-xl\">Générer Facture</h1>\n        </div>\n        <button \n          onClick={handleDownload}\n          className=\"bg-blue-600 text-white px-4 py-2 rounded flex items-center gap-2 hover:bg-blue-700\"\n        >\n          <Download size={18} /> Télécharger PDF\n        </button>\n      </div>\n\n      <div className=\"flex flex-1 p-8 gap-8 justify-center\">\n        {/* Form Panel */}\n        <div className=\"w-80 bg-white p-6 rounded shadow h-fit sticky top-24\">\n          <h3 className=\"font-bold mb-4\">Données de la facture</h3>\n          <p className=\"text-sm text-gray-500 mb-4\">\n            Utilisez <code>{`{{client}}`}</code>, <code>{`{{date}}`}</code>, <code>{`{{number}}`}</code> dans vos textes pour les remplacer dynamiquement.\n          </p>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Client</label>\n              <input \n                type=\"text\" \n                value={variables.client} \n                onChange={e => setVariables({...variables, client: e.target.value})}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Numéro</label>\n              <input \n                type=\"text\" \n                value={variables.number} \n                onChange={e => setVariables({...variables, number: e.target.value})}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Date</label>\n              <input \n                type=\"text\" \n                value={variables.date} \n                onChange={e => setVariables({...variables, date: e.target.value})}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2\"\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Preview */}\n        <div className=\"overflow-auto shadow-lg bg-white\">\n          <div id=\"print-target\">\n             <InvoiceRenderer elements={renderedElements} />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}}]
}