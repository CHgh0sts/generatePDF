{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/chghosts/Developpement/test%20gemini%203/components/InvoiceRenderer.tsx"],"sourcesContent":["import React from 'react';\n\nexport interface GlobalSettings {\n  padding: number;\n  headerHeight?: number;\n  footerHeight?: number;\n}\n\nexport interface TableColumn {\n  id: string;\n  label: string;\n  value?: string; // Valeur de la cellule (peut contenir des variables {{...}})\n  width?: number;\n  align?: 'left' | 'center' | 'right'; // Alignement du texte dans la colonne\n  fontWeight?: 'normal' | 'bold'; // Gras\n  fontStyle?: 'normal' | 'italic'; // Italique\n  textDecoration?: 'none' | 'underline'; // Souligné\n}\n\nexport interface EditorElement {\n  id: string;\n  type: 'text' | 'image' | 'box' | 'line' | 'table' | 'container';\n  x: number;\n  y: number;\n  w: number | string;\n  h: number | string;\n  parentId?: string | null;\n  content?: string;\n  style?: React.CSSProperties;\n  data?: any; // Pour les données complexes comme les tableaux\n  columns?: TableColumn[]; // Pour les colonnes des tableaux\n}\n\nexport default function InvoiceRenderer({ elements, globalSettings, id }: { elements: EditorElement[], globalSettings?: GlobalSettings, id?: string }) {\n  const padding = globalSettings?.padding ?? 0;\n  const headerHeight = globalSettings?.headerHeight ?? 0;\n  const footerHeight = globalSettings?.footerHeight ?? 0;\n\n  // Helper pour le rendu récursif\n  const renderElement = (element: EditorElement) => {\n    const children = elements.filter(e => e.parentId === element.id);\n\n    return (\n        <div\n          key={element.id}\n          style={{\n            position: 'absolute',\n            top: element.y,\n            left: element.x,\n            width: element.w,\n            height: element.h,\n            ...element.style,\n          }}\n        >\n          {element.type === 'text' && (\n            <div \n              className=\"w-full h-full whitespace-pre-wrap\" \n              style={{ \n                color: element.style?.color,\n                textAlign: element.style?.textAlign as any,\n                fontSize: element.style?.fontSize,\n                fontWeight: element.style?.fontWeight,\n                fontStyle: element.style?.fontStyle,\n                textDecoration: element.style?.textDecoration\n              }}\n            >\n              {element.content}\n            </div>\n          )}\n          \n          {(element.type === 'box' || element.type === 'container') && (\n            <div \n              className=\"w-full h-full relative\"\n              style={{ \n                backgroundColor: element.style?.backgroundColor || (element.type === 'container' ? 'transparent' : '#e5e7eb'), \n                borderColor: element.style?.borderColor || '#9ca3af',\n                borderWidth: element.style?.borderWidth || '1px',\n                borderStyle: 'solid',\n                borderRadius: element.style?.borderRadius || '0px'\n              }} \n            >\n               {/* Rendu des enfants pour les conteneurs */}\n               {children.map(renderElement)}\n            </div>\n          )}\n\n          {element.type === 'image' && element.content && (\n            <div \n              className=\"w-full h-full overflow-hidden\"\n              style={{\n                borderRadius: element.style?.borderRadius || '0px'\n              }}\n            >\n              {/* eslint-disable-next-line @next/next/no-img-element */}\n              <img \n                src={element.content} \n                alt=\"Element\" \n                className=\"w-full h-full object-cover block\" \n                style={{\n                  pointerEvents: 'none' \n                }}\n              />\n            </div>\n          )}\n          \n          {element.type === 'line' && (\n            <div \n              className=\"w-full h-full flex items-center\"\n            >\n               <div \n                 className=\"w-full\" \n                 style={{ \n                   height: element.style?.height || '2px', \n                   backgroundColor: element.style?.backgroundColor || 'black' \n                 }} \n               />\n            </div>\n          )}\n\n          {element.type === 'table' && (\n            <div className=\"w-full h-full overflow-hidden\">\n              <table className=\"w-full border-collapse text-sm text-gray-900\">\n                <thead>\n                  <tr style={{ backgroundColor: element.style?.backgroundColor || '#f3f4f6' }}>\n                    {(element.columns || [{ id: '1', label: 'Colonne 1' }, { id: '2', label: 'Colonne 2' }]).map((col) => (\n                      <th \n                        key={col.id} \n                        className=\"border p-2 text-gray-900\"\n                        style={{ \n                          borderColor: element.style?.borderColor || '#d1d5db',\n                          minWidth: col.width || 100,\n                          textAlign: col.align || 'left',\n                          fontWeight: col.fontWeight || 'bold',\n                          fontStyle: col.fontStyle || 'normal',\n                          textDecoration: col.textDecoration || 'none'\n                        }}\n                      >\n                        {col.label}\n                      </th>\n                    ))}\n                  </tr>\n                </thead>\n                <tbody>\n                  {/* Afficher les lignes de données si disponibles, sinon afficher des exemples */}\n                  {element.data?.rows && element.data.rows.length > 0 ? (\n                    element.data.rows.map((row: Record<string, string>, rowIndex: number) => (\n                      <tr key={rowIndex}>\n                        {(element.columns || []).map((col) => (\n                          <td \n                            key={col.id} \n                            className=\"border p-2 text-gray-900\"\n                            style={{ \n                              borderColor: element.style?.borderColor || '#d1d5db',\n                              textAlign: col.align || 'left',\n                              fontWeight: col.fontWeight || 'normal',\n                              fontStyle: col.fontStyle || 'normal',\n                              textDecoration: col.textDecoration || 'none'\n                            }}\n                          >\n                            {row[col.id] || col.value || ''}\n                          </td>\n                        ))}\n                      </tr>\n                    ))\n                  ) : (\n                    <>\n                      <tr>\n                        {(element.columns || [{ id: '1', label: 'Colonne 1' }, { id: '2', label: 'Colonne 2' }]).map((col) => (\n                          <td \n                            key={col.id} \n                            className=\"border p-2 text-gray-900\"\n                            style={{ \n                              borderColor: element.style?.borderColor || '#d1d5db',\n                              textAlign: col.align || 'left',\n                              fontWeight: col.fontWeight || 'normal',\n                              fontStyle: col.fontStyle || 'normal',\n                              textDecoration: col.textDecoration || 'none'\n                            }}\n                          >\n                            {col.value || 'Exemple'}\n                          </td>\n                        ))}\n                      </tr>\n                      <tr>\n                        {(element.columns || [{ id: '1', label: 'Colonne 1' }, { id: '2', label: 'Colonne 2' }]).map((col) => (\n                          <td \n                            key={col.id} \n                            className=\"border p-2 text-gray-900\"\n                            style={{ \n                              borderColor: element.style?.borderColor || '#d1d5db',\n                              textAlign: col.align || 'left',\n                              fontWeight: col.fontWeight || 'normal',\n                              fontStyle: col.fontStyle || 'normal',\n                              textDecoration: col.textDecoration || 'none'\n                            }}\n                          >\n                            {col.value || 'Exemple'}\n                          </td>\n                        ))}\n                      </tr>\n                    </>\n                  )}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n    );\n  };\n\n  // On ne rend que les éléments racine (sans parent)\n  const rootElements = elements.filter(el => !el.parentId);\n\n  return (\n    <div \n      id={id}\n      className=\"bg-white shadow-none relative print:shadow-none\"\n      style={{ \n        width: '794px', \n        height: '1123px', \n        position: 'relative', \n        overflow: 'hidden',\n        padding: `${padding}px`,\n        paddingTop: `${padding + headerHeight}px`,\n        paddingBottom: `${padding + footerHeight}px`\n      }}\n    >\n      <div style={{ position: 'relative', width: '100%', height: '100%' }}>\n         {rootElements.map(renderElement)}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 305, "column": 0}, "map": {"version":3,"sources":["file:///Users/chghosts/Developpement/test%20gemini%203/app/dashboard/generate/%5Bid%5D/PdfGenerator.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef } from 'react';\nimport InvoiceRenderer, { EditorElement, GlobalSettings } from '@/components/InvoiceRenderer';\nimport html2canvas from 'html2canvas';\nimport jsPDF from 'jspdf';\nimport { Download, ArrowLeft, AlertCircle, Plus, Trash2, Table as TableIcon } from 'lucide-react';\nimport Link from 'next/link';\n\nexport default function PdfGenerator({ template }: { template: any }) {\n  const [elements, setElements] = useState<EditorElement[]>([]);\n  const [globalSettings, setGlobalSettings] = useState<GlobalSettings | undefined>(undefined);\n\n  const [isGenerating, setIsGenerating] = useState(false);\n\n  // État pour les variables détectées\n  const [variables, setVariables] = useState<Record<string, string>>({});\n  const [detectedVars, setDetectedVars] = useState<string[]>([]);\n  \n  // État pour les lignes des tableaux : { tableId: [ { colId: value }, ... ] }\n  const [tableRows, setTableRows] = useState<Record<string, Record<string, string>[]>>({});\n\n  React.useEffect(() => {\n    try {\n       const parsed = JSON.parse(template.content);\n       let parsedElements: EditorElement[] = [];\n       \n       if (Array.isArray(parsed)) {\n          parsedElements = parsed;\n          setElements(parsed);\n       } else {\n          parsedElements = parsed.elements || [];\n          setElements(parsed.elements || []);\n          setGlobalSettings(parsed.globalSettings);\n       }\n\n       // Détecter toutes les variables {{...}} dans le template\n       const varSet = new Set<string>();\n       const varRegex = /\\{\\{(\\w+)\\}\\}/g;\n       \n       parsedElements.forEach(el => {\n         if (el.type === 'text' && el.content) {\n           let match;\n           while ((match = varRegex.exec(el.content)) !== null) {\n             varSet.add(match[1]);\n           }\n         }\n         \n         // Vérifier aussi dans les colonnes de tableau (label et value)\n         if (el.type === 'table' && el.columns) {\n           el.columns.forEach(col => {\n             if (col.label) {\n               let match;\n               while ((match = varRegex.exec(col.label)) !== null) {\n                 varSet.add(match[1]);\n               }\n             }\n             if (col.value) {\n               let match;\n               while ((match = varRegex.exec(col.value)) !== null) {\n                 varSet.add(match[1]);\n               }\n             }\n           });\n         }\n       });\n\n       const varsArray = Array.from(varSet).sort();\n       setDetectedVars(varsArray);\n       \n       // Initialiser les variables avec des valeurs par défaut\n       const initialVars: Record<string, string> = {};\n       varsArray.forEach(varName => {\n         initialVars[varName] = '';\n       });\n       setVariables(initialVars);\n       \n       // Initialiser les tableaux avec une ligne vide par défaut\n       const initialTableRows: Record<string, Record<string, string>[]> = {};\n       parsedElements.forEach(el => {\n         if (el.type === 'table' && el.columns && el.columns.length > 0) {\n           const emptyRow: Record<string, string> = {};\n           el.columns.forEach(col => {\n             emptyRow[col.id] = '';\n           });\n           initialTableRows[el.id] = [emptyRow];\n         }\n       });\n       setTableRows(initialTableRows);\n       \n    } catch {\n       setElements([]);\n    }\n  }, [template.content]);\n\n  const rendererRef = useRef<HTMLDivElement>(null);\n\n  const handleDownload = async () => {\n    setIsGenerating(true);\n    \n    try {\n      // Fonction pour normaliser les couleurs en format supporté\n      const normalizeColor = (color: any): any => {\n        if (typeof color !== 'string') return color;\n        // Si c'est déjà un format valide (hex, rgb, rgba), on le garde\n        if (color.match(/^#[0-9a-fA-F]{3,8}$/) || \n            color.match(/^rgba?\\(/i) || \n            color.match(/^hsla?\\(/i)) {\n          return color;\n        }\n        // Pour tout autre format non standard, on retourne une couleur par défaut\n        return color;\n      };\n\n      // Fonction pour nettoyer les styles\n      const cleanStyle = (style: any) => {\n        if (!style) return style;\n        const cleaned = { ...style };\n        if (cleaned.backgroundColor) cleaned.backgroundColor = normalizeColor(cleaned.backgroundColor);\n        if (cleaned.color) cleaned.color = normalizeColor(cleaned.color);\n        if (cleaned.borderColor) cleaned.borderColor = normalizeColor(cleaned.borderColor);\n        return cleaned;\n      };\n\n      // Prétraitement des images : Conversion URL externe -> Base64 via Proxy\n      // Cela contourne les restrictions CORS de html2canvas pour les URLs externes\n      const processedElements = await Promise.all(elements.map(async (el) => {\n        // Nettoyer les styles de l'élément\n        const cleanedEl = { ...el, style: cleanStyle(el.style) };\n        \n        if (el.type === 'image' && el.content && el.content.startsWith('http')) {\n          try {\n            const response = await fetch(`/api/proxy-image?url=${encodeURIComponent(el.content)}`);\n            if (!response.ok) throw new Error('Proxy failed');\n            const blob = await response.blob();\n            const base64 = await new Promise<string>((resolve) => {\n               const reader = new FileReader();\n               reader.onloadend = () => resolve(reader.result as string);\n               reader.readAsDataURL(blob);\n            });\n            return { ...cleanedEl, content: base64 };\n          } catch (e) {\n            console.error('Image processing failed', e);\n            return cleanedEl;\n          }\n        }\n        return cleanedEl;\n      }));\n\n      setElements(processedElements);\n\n      // Attendre que React mette à jour le DOM avec les nouvelles sources d'images (Base64)\n      await new Promise(resolve => setTimeout(resolve, 1000));\n\n      const element = document.getElementById('print-target');\n      if (!element) return;\n      \n      // Créer une copie temporaire pour le rendu sans les classes Tailwind problématiques\n      const tempContainer = document.createElement('div');\n      tempContainer.style.position = 'absolute';\n      tempContainer.style.left = '-9999px';\n      tempContainer.style.top = '0';\n      tempContainer.innerHTML = element.innerHTML;\n      document.body.appendChild(tempContainer);\n      \n      // Remplacer toutes les classes text-gray-* par des styles inline\n      const allTextElements = tempContainer.querySelectorAll('.text-gray-900, .text-gray-800, .text-gray-700, .text-gray-600');\n      allTextElements.forEach((el: any) => {\n        el.style.color = 'rgb(17, 24, 39)'; // gray-900 en RGB\n        el.classList.remove('text-gray-900', 'text-gray-800', 'text-gray-700', 'text-gray-600');\n      });\n      \n      // Remplacer les bg-gray-* \n      const allBgElements = tempContainer.querySelectorAll('.bg-gray-50, .bg-gray-100');\n      allBgElements.forEach((el: any) => {\n        el.style.backgroundColor = 'rgb(249, 250, 251)'; // gray-50 en RGB\n        el.classList.remove('bg-gray-50', 'bg-gray-100');\n      });\n  \n      const canvas = await html2canvas(tempContainer, {\n        scale: 2,\n        logging: false,\n        useCORS: true,\n        allowTaint: false,\n        foreignObjectRendering: false,\n        onclone: (clonedDoc) => {\n          // Nettoyer tous les styles inline et computed problématiques dans le document cloné\n          const allElements = clonedDoc.querySelectorAll('*');\n          allElements.forEach((el: any) => {\n            // Obtenir le style calculé de l'élément original\n            const originalEl = document.querySelector(`[data-element-id=\"${el.getAttribute('data-element-id')}\"]`) || el;\n            const computedStyle = window.getComputedStyle(originalEl);\n            \n            // Forcer les couleurs en format RGB/RGBA\n            ['backgroundColor', 'color', 'borderColor', 'borderTopColor', 'borderRightColor', 'borderBottomColor', 'borderLeftColor'].forEach(prop => {\n              try {\n                const computed = (computedStyle as any)[prop];\n                if (computed && computed !== 'transparent' && computed !== 'rgba(0, 0, 0, 0)') {\n                  // Convertir toute couleur en RGB pour éviter les formats non supportés\n                  if (computed.includes('lab(') || computed.includes('lch(') || computed.includes('oklch(') || \n                      !computed.match(/^(#|rgb|rgba|transparent)/i)) {\n                    // Utiliser une valeur par défaut sûre\n                    if (prop.includes('background')) {\n                      el.style[prop] = 'rgb(255, 255, 255)';\n                    } else if (prop.includes('border')) {\n                      el.style[prop] = 'rgb(209, 213, 219)'; // gray-300\n                    } else {\n                      el.style[prop] = 'rgb(0, 0, 0)';\n                    }\n                  } else {\n                    el.style[prop] = computed;\n                  }\n                }\n              } catch (e) {\n                // En cas d'erreur, utiliser une valeur sûre\n                console.warn('Color conversion error for', prop, e);\n              }\n            });\n            \n            // Forcer aussi les bordures à être explicites\n            if (el.style.border || computedStyle.border) {\n              const borderWidth = computedStyle.borderWidth || '1px';\n              const borderStyle = computedStyle.borderStyle || 'solid';\n              const borderColor = computedStyle.borderColor || 'rgb(209, 213, 219)';\n              \n              if (borderColor.includes('lab(') || borderColor.includes('lch(')) {\n                el.style.border = `${borderWidth} ${borderStyle} rgb(209, 213, 219)`;\n              }\n            }\n          });\n        }\n      });\n  \n      const imgData = canvas.toDataURL('image/png');\n      const pdf = new jsPDF('p', 'mm', 'a4');\n      const pdfWidth = pdf.internal.pageSize.getWidth();\n      const pdfHeight = pdf.internal.pageSize.getHeight();\n      \n      pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);\n      \n      // Nom du fichier basé sur la première variable ou le nom du template\n      const firstVar = detectedVars.length > 0 ? variables[detectedVars[0]] : template.name;\n      const fileName = firstVar ? `${firstVar.replace(/[^a-z0-9]/gi, '_')}.pdf` : 'document.pdf';\n      pdf.save(fileName);\n      \n      // Nettoyer le conteneur temporaire\n      document.body.removeChild(tempContainer);\n    } catch (error) {\n      console.error('PDF generation error:', error);\n      // Nettoyer en cas d'erreur aussi\n      const tempContainer = document.querySelector('div[style*=\"-9999px\"]');\n      if (tempContainer) document.body.removeChild(tempContainer);\n      throw error;\n    } finally {\n      setIsGenerating(false);\n    }\n  };\n\n  // Inject variables into elements for rendering\n  const renderedElements = elements.map(el => {\n    if (el.type === 'text' && el.content) {\n      let newContent = el.content;\n      Object.entries(variables).forEach(([key, value]) => {\n        newContent = newContent.replace(new RegExp(`{{${key}}}`, 'g'), value);\n      });\n      return { ...el, content: newContent };\n    }\n    \n    // Inject table rows data\n    if (el.type === 'table') {\n      const rows = tableRows[el.id] || [];\n      // Remplacer les variables dans les valeurs des lignes\n      const processedRows = rows.map(row => {\n        const processedRow: Record<string, string> = {};\n        Object.entries(row).forEach(([colId, value]) => {\n          let newValue = value;\n          Object.entries(variables).forEach(([key, varValue]) => {\n            newValue = newValue.replace(new RegExp(`{{${key}}}`, 'g'), varValue);\n          });\n          processedRow[colId] = newValue;\n        });\n        return processedRow;\n      });\n      \n      return { ...el, data: { rows: processedRows } };\n    }\n    \n    return el;\n  });\n\n  return (\n    <div className=\"min-h-screen bg-gray-100/50 flex flex-col\">\n      <div className=\"bg-white border-b border-gray-200 sticky top-0 z-20 shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/dashboard\" className=\"p-2 text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors\">\n               <ArrowLeft size={20} />\n            </Link>\n            <div>\n               <h1 className=\"font-bold text-gray-900 text-lg\">Générer la facture</h1>\n               <p className=\"text-xs text-gray-800\">Modèle : {template.name}</p>\n            </div>\n          </div>\n          <button \n            onClick={handleDownload}\n            disabled={isGenerating}\n            className=\"bg-green-600 text-white px-5 py-2.5 rounded-full font-medium flex items-center gap-2 hover:bg-green-700 shadow-lg shadow-green-600/20 transition-all hover:-translate-y-0.5 disabled:opacity-70 disabled:cursor-wait\"\n          >\n            {isGenerating ? (\n              <>\n                <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent\"></div>\n                Génération...\n              </>\n            ) : (\n              <>\n                <Download size={18} /> Télécharger PDF\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n\n      <div className=\"flex flex-1 max-w-7xl mx-auto w-full p-8 gap-8 justify-center items-start\">\n        {/* Form Panel */}\n        <div className=\"w-96 bg-white p-6 rounded-xl shadow-sm border border-gray-200 sticky top-24 max-h-[calc(100vh-8rem)] overflow-y-auto\">\n          {/* Variables Section */}\n          {detectedVars.length > 0 && (\n            <div className=\"mb-8\">\n              <h3 className=\"font-bold text-gray-900 text-lg mb-2\">Données variables</h3>\n              <div className=\"flex items-start gap-3 p-3 bg-blue-50 rounded-lg border border-blue-100 mb-6\">\n                <AlertCircle className=\"text-blue-600 shrink-0 mt-0.5\" size={18} />\n                <p className=\"text-xs text-blue-700 leading-relaxed\">\n                  Remplissez les champs ci-dessous pour mettre à jour la facture en temps réel.\n                </p>\n              </div>\n              \n              <div className=\"space-y-5\">\n                {detectedVars.map(varName => (\n                  <div key={varName}>\n                    <label htmlFor={`var-${varName}`} className=\"block text-sm font-medium text-gray-800 mb-1.5 capitalize\">\n                      {varName.replace(/([A-Z])/g, ' $1').trim()}\n                    </label>\n                    <input \n                      id={`var-${varName}`}\n                      type=\"text\" \n                      value={variables[varName] || ''} \n                      onChange={e => setVariables({...variables, [varName]: e.target.value})}\n                      className=\"block w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm transition-shadow\"\n                      placeholder={`Entrez ${varName}`}\n                    />\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Tables Section */}\n          {elements.filter(el => el.type === 'table').map(tableElement => {\n            const tableColumns = tableElement.columns || [];\n            const rows = tableRows[tableElement.id] || [];\n            \n            if (tableColumns.length === 0) return null;\n            \n            return (\n              <div key={tableElement.id} className=\"mb-8 pb-8 border-b border-gray-200 last:border-b-0\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                  <TableIcon size={20} className=\"text-gray-700\" />\n                  <h3 className=\"font-bold text-gray-900 text-lg\">Lignes du tableau</h3>\n                </div>\n                \n                <div className=\"space-y-4\">\n                  {rows.map((row, rowIndex) => (\n                    <div key={rowIndex} className=\"bg-gray-50 rounded-lg border border-gray-200 p-4\">\n                      <div className=\"flex items-center justify-between mb-3\">\n                        <span className=\"text-sm font-medium text-gray-700\">Ligne {rowIndex + 1}</span>\n                        <button\n                          onClick={() => {\n                            const newRows = rows.filter((_, i) => i !== rowIndex);\n                            setTableRows({ ...tableRows, [tableElement.id]: newRows });\n                          }}\n                          className=\"p-1.5 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors\"\n                          title=\"Supprimer la ligne\"\n                        >\n                          <Trash2 size={16} />\n                        </button>\n                      </div>\n                      \n                      <div className=\"space-y-3\">\n                        {tableColumns.map(col => (\n                          <div key={col.id}>\n                            <label htmlFor={`table-${tableElement.id}-row-${rowIndex}-col-${col.id}`} className=\"block text-xs font-medium text-gray-800 mb-1\">\n                              {col.label}\n                            </label>\n                            <input\n                              id={`table-${tableElement.id}-row-${rowIndex}-col-${col.id}`}\n                              type=\"text\"\n                              value={row[col.id] || ''}\n                              onChange={(e) => {\n                                const newRows = [...rows];\n                                newRows[rowIndex] = { ...row, [col.id]: e.target.value };\n                                setTableRows({ ...tableRows, [tableElement.id]: newRows });\n                              }}\n                              className=\"block w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-gray-900 text-sm focus:border-blue-500 focus:ring-blue-500\"\n                              placeholder={col.value || `Valeur pour ${col.label}`}\n                            />\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  ))}\n                  \n                  <button\n                    onClick={() => {\n                      const emptyRow: Record<string, string> = {};\n                      tableColumns.forEach(col => {\n                        emptyRow[col.id] = '';\n                      });\n                      setTableRows({ ...tableRows, [tableElement.id]: [...rows, emptyRow] });\n                    }}\n                    className=\"w-full py-2.5 px-4 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors\"\n                  >\n                    <Plus size={18} />\n                    Ajouter une ligne\n                  </button>\n                </div>\n              </div>\n            );\n          })}\n          \n          {detectedVars.length === 0 && elements.filter(el => el.type === 'table').length === 0 && (\n            <div className=\"text-center py-8\">\n              <p className=\"text-gray-500 text-sm\">Aucune variable ou tableau détecté dans ce modèle.</p>\n              <p className=\"text-gray-400 text-xs mt-2\">Utilisez la syntaxe <code className=\"bg-gray-100 px-1.5 py-0.5 rounded\">{'{{nomVariable}}'}</code> dans vos éléments.</p>\n            </div>\n          )}\n        </div>\n\n        {/* Preview */}\n        <div className=\"flex-1 overflow-auto flex justify-center\">\n           <div className=\"bg-white shadow-2xl border border-gray-200\">\n              <div id=\"print-target\">\n                 <InvoiceRenderer elements={renderedElements} globalSettings={globalSettings} />\n              </div>\n           </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}