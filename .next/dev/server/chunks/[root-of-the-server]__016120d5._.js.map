{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/chghosts/Developpement/test%20gemini%203/lib/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from 'jose';\nimport { cookies } from 'next/headers';\nimport { NextRequest, NextResponse } from 'next/server';\n\nconst secretKey = process.env.JWT_SECRET || 'super_secret_jwt_key_change_me_in_prod';\nconst key = new TextEncoder().encode(secretKey);\n\nexport async function encrypt(payload: any) {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('24h')\n    .sign(key);\n}\n\nexport async function decrypt(input: string): Promise<any> {\n  const { payload } = await jwtVerify(input, key, {\n    algorithms: ['HS256'],\n  });\n  return payload;\n}\n\nexport async function getSession() {\n  const cookieStore = await cookies();\n  const session = cookieStore.get('session')?.value;\n  if (!session) return null;\n  try {\n    return await decrypt(session);\n  } catch (error) {\n    return null;\n  }\n}\n\nexport async function login(formData: FormData) {\n  // Verify credentials and create session\n  // This will be called from the API route, but helper here\n}\n\nexport async function logout() {\n  const cookieStore = await cookies();\n  cookieStore.delete('session');\n}\n\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;AACA;;;AAGA,MAAM,YAAY,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC5C,MAAM,MAAM,IAAI,cAAc,MAAM,CAAC;AAE9B,eAAe,QAAQ,OAAY;IACxC,OAAO,MAAM,IAAI,kKAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,OAClB,IAAI,CAAC;AACV;AAEO,eAAe,QAAQ,KAAa;IACzC,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO,KAAK;QAC9C,YAAY;YAAC;SAAQ;IACvB;IACA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,UAAU,YAAY,GAAG,CAAC,YAAY;IAC5C,IAAI,CAAC,SAAS,OAAO;IACrB,IAAI;QACF,OAAO,MAAM,QAAQ;IACvB,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,MAAM,QAAkB;AAC5C,wCAAwC;AACxC,0DAA0D;AAC5D;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Users/chghosts/Developpement/test%20gemini%203/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma = globalForPrisma.prisma || new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///Users/chghosts/Developpement/test%20gemini%203/app/api/routes/%5Bid%5D/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { getSession } from '@/lib/auth';\nimport { prisma } from '@/lib/prisma';\n\n// GET - Récupérer une route spécifique\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const session = await getSession();\n    if (!session) {\n      return NextResponse.json({ error: 'Non autorisé' }, { status: 401 });\n    }\n\n    const { id } = await params;\n\n    const route = await prisma.apiRoute.findUnique({\n      where: { id },\n      include: {\n        template: {\n          select: { name: true }\n        }\n      }\n    });\n\n    if (!route || route.userId !== session.user.id) {\n      return NextResponse.json({ error: 'Route non trouvée' }, { status: 404 });\n    }\n\n    return NextResponse.json(route);\n  } catch (error) {\n    console.error('Erreur GET route:', error);\n    return NextResponse.json({ error: 'Erreur serveur' }, { status: 500 });\n  }\n}\n\n// PATCH - Mettre à jour une route\nexport async function PATCH(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const session = await getSession();\n    if (!session) {\n      return NextResponse.json({ error: 'Non autorisé' }, { status: 401 });\n    }\n\n    const { id } = await params;\n    const body = await request.json();\n\n    // Vérifier que la route appartient à l'utilisateur\n    const route = await prisma.apiRoute.findUnique({\n      where: { id }\n    });\n\n    if (!route || route.userId !== session.user.id) {\n      return NextResponse.json({ error: 'Route non trouvée' }, { status: 404 });\n    }\n\n    const updated = await prisma.apiRoute.update({\n      where: { id },\n      data: body,\n      include: {\n        template: {\n          select: { name: true }\n        }\n      }\n    });\n\n    return NextResponse.json(updated);\n  } catch (error) {\n    console.error('Erreur PATCH route:', error);\n    return NextResponse.json({ error: 'Erreur serveur' }, { status: 500 });\n  }\n}\n\n// DELETE - Supprimer une route\nexport async function DELETE(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const session = await getSession();\n    if (!session) {\n      return NextResponse.json({ error: 'Non autorisé' }, { status: 401 });\n    }\n\n    const { id } = await params;\n\n    // Vérifier que la route appartient à l'utilisateur\n    const route = await prisma.apiRoute.findUnique({\n      where: { id }\n    });\n\n    if (!route || route.userId !== session.user.id) {\n      return NextResponse.json({ error: 'Route non trouvée' }, { status: 404 });\n    }\n\n    await prisma.apiRoute.delete({\n      where: { id }\n    });\n\n    return NextResponse.json({ success: true });\n  } catch (error) {\n    console.error('Erreur DELETE route:', error);\n    return NextResponse.json({ error: 'Erreur serveur' }, { status: 500 });\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}