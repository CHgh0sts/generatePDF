{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from 'jose';\nimport { cookies } from 'next/headers';\nimport { NextRequest, NextResponse } from 'next/server';\n\nconst secretKey = process.env.JWT_SECRET || 'super_secret_jwt_key_change_me_in_prod';\nconst key = new TextEncoder().encode(secretKey);\n\nexport async function encrypt(payload: any) {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime('24h')\n    .sign(key);\n}\n\nexport async function decrypt(input: string): Promise<any> {\n  const { payload } = await jwtVerify(input, key, {\n    algorithms: ['HS256'],\n  });\n  return payload;\n}\n\nexport async function getSession() {\n  const cookieStore = await cookies();\n  const session = cookieStore.get('session')?.value;\n  if (!session) return null;\n  try {\n    return await decrypt(session);\n  } catch (error) {\n    return null;\n  }\n}\n\nexport async function login(formData: FormData) {\n  // Verify credentials and create session\n  // This will be called from the API route, but helper here\n}\n\nexport async function logout() {\n  const cookieStore = await cookies();\n  cookieStore.delete('session');\n}\n\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;AACA;AAAA;;;AAGA,MAAM,YAAY,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC5C,MAAM,MAAM,IAAI,cAAc,MAAM,CAAC;AAE9B,eAAe,QAAQ,OAAY;IACxC,OAAO,MAAM,IAAI,wKAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,OAClB,IAAI,CAAC;AACV;AAEO,eAAe,QAAQ,KAAa;IACzC,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,4KAAS,EAAC,OAAO,KAAK;QAC9C,YAAY;YAAC;SAAQ;IACvB;IACA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,MAAM,UAAU,YAAY,GAAG,CAAC,YAAY;IAC5C,IAAI,CAAC,SAAS,OAAO;IACrB,IAAI;QACF,OAAO,MAAM,QAAQ;IACvB,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,MAAM,QAAkB;AAC5C,wCAAwC;AACxC,0DAA0D;AAC5D;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\nimport { decrypt } from '@/lib/auth';\n\nexport async function middleware(request: NextRequest) {\n  const session = request.cookies.get('session')?.value;\n\n  if (request.nextUrl.pathname.startsWith('/dashboard')) {\n    if (!session) {\n      return NextResponse.redirect(new URL('/login', request.url));\n    }\n\n    try {\n      const payload = await decrypt(session);\n      if (!payload) {\n        return NextResponse.redirect(new URL('/login', request.url));\n      }\n    } catch (e) {\n      return NextResponse.redirect(new URL('/login', request.url));\n    }\n  }\n  \n  if ((request.nextUrl.pathname === '/login' || request.nextUrl.pathname === '/register') && session) {\n     try {\n      await decrypt(session);\n      return NextResponse.redirect(new URL('/dashboard', request.url));\n    } catch (e) {\n      // Session invalid, let them login\n    }\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: ['/dashboard/:path*', '/login', '/register'],\n};\n\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,UAAU,QAAQ,OAAO,CAAC,GAAG,CAAC,YAAY;IAEhD,IAAI,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe;QACrD,IAAI,CAAC,SAAS;YACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,IAAI;YACF,MAAM,UAAU,MAAM,IAAA,8HAAO,EAAC;YAC9B,IAAI,CAAC,SAAS;gBACZ,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;YAC5D;QACF,EAAE,OAAO,GAAG;YACV,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;IACF;IAEA,IAAI,CAAC,QAAQ,OAAO,CAAC,QAAQ,KAAK,YAAY,QAAQ,OAAO,CAAC,QAAQ,KAAK,WAAW,KAAK,SAAS;QACjG,IAAI;YACH,MAAM,IAAA,8HAAO,EAAC;YACd,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;QAChE,EAAE,OAAO,GAAG;QACV,kCAAkC;QACpC;IACF;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAqB;QAAU;KAAY;AACvD"}}]
}